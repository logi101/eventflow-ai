---
phase: 07-networking-vip-infrastructure
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - eventflow-app/src/components/participants/VIPBadge.tsx
  - eventflow-app/src/hooks/useVIPSorting.ts
  - eventflow-app/supabase/seed-vip-templates.sql
autonomous: true

must_haves:
  truths:
    - "VIP participants display subtle diamond icon (ğŸ’) in participant lists"
    - "VIPs appear at top of participant lists when sorted"
    - "WhatsApp templates exist for VIP-specific messages with room and table variables"
  artifacts:
    - path: "eventflow-app/src/components/participants/VIPBadge.tsx"
      provides: "Reusable VIP indicator component"
      min_lines: 20
    - path: "eventflow-app/src/hooks/useVIPSorting.ts"
      provides: "Hook for VIP-prioritized sorting"
      exports: ["useVIPSorting"]
    - path: "eventflow-app/supabase/seed-vip-templates.sql"
      provides: "VIP WhatsApp message templates"
      contains: "INSERT INTO message_templates"
  key_links:
    - from: "VIPBadge.tsx"
      to: "participants.is_vip"
      via: "prop boolean"
      pattern: "is_vip.*boolean"
---

<objective>
Create VIP visual treatment components and VIP-specific WhatsApp message templates

Purpose: Ensure VIP participants are visually distinguished throughout the system with subtle indicators and receive personalized messages
Output: VIPBadge component, useVIPSorting hook, and VIP message templates with room/table variables
</objective>

<execution_context>
@/Users/eliyawolfman/.claude/get-shit-done/workflows/execute-plan.md
@/Users/eliyawolfman/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-networking-vip-infrastructure/07-CONTEXT.md
@.planning/phases/07-networking-vip-infrastructure/07-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create VIPBadge component and useVIPSorting hook</name>
  <files>eventflow-app/src/components/participants/VIPBadge.tsx, eventflow-app/src/hooks/useVIPSorting.ts</files>
  <action>
1. **Create VIPBadge.tsx:**
   - Props: size ('xs' | 'sm' | 'md'), optional className
   - Display diamond emoji (ğŸ’) with subtle purple color (text-purple-600 opacity-70)
   - Include Hebrew title attribute "××©×ª×ª×£ VIP"
   - Support three sizes with appropriate text classes
   - Subtle, not bold or prominent (per CONTEXT.md decision)

   ```typescript
   interface VIPBadgeProps {
     size?: 'xs' | 'sm' | 'md'
     className?: string
   }
   ```

2. **Create useVIPSorting hook:**
   - Generic hook that sorts array with is_vip field
   - VIPs appear first, then rest in original order
   - Uses useMemo for performance
   - Returns sorted array

   ```typescript
   export function useVIPSorting<T extends { is_vip: boolean }>(data: T[]): T[]
   ```

Both files must:
- Be RTL-ready (no LTR-specific styling)
- Follow EventFlow naming conventions (Tailwind, TypeScript)
- Include JSDoc comments in Hebrew
  </action>
  <verify>
- TypeScript compiles without errors
- VIPBadge renders diamond emoji with correct styling
- useVIPSorting correctly sorts VIPs to top
  </verify>
  <done>VIPBadge component and useVIPSorting hook exist and export correctly</done>
</task>

<task type="auto">
  <name>Task 2: Create VIP-specific WhatsApp message templates</name>
  <files>eventflow-app/supabase/seed-vip-templates.sql</files>
  <action>
Create SQL seed file with VIP-specific message templates. Templates must include room and table variables as per VIP-02 and ROOM-03 requirements.

1. **VIP Check-in Template:**
   ```sql
   INSERT INTO message_templates (
     name, message_type, channel, subject, content, variables, is_system
   ) VALUES (
     '×¦×³×§-××™×Ÿ VIP ×¢× ×¤×¨×˜×™ ×—×“×¨',
     'custom',
     'whatsapp',
     '×‘×¨×•×›×™× ×”×‘××™× - VIP',
     '×©×œ×•× {{first_name}}! ğŸ‘‹ğŸ’

×‘×¨×•×›×™× ×”×‘××™× ×œ{{event_name}}!

×›××©×ª×ª×£ VIP, ×× ×—× ×• ×©××—×™× ×œ××¨×— ××•×ª×š.

ğŸ“ ×¤×¨×˜×™ ×”×œ×™× ×” ×©×œ×š:
ğŸ¨ ×‘× ×™×™×Ÿ: {{room_building}}
ğŸšª ×—×“×¨: {{room_number}}
ğŸ”¢ ×§×•××”: {{room_floor}}
â° ×¦×³×§-××™×Ÿ: {{checkin_time}}

ğŸª‘ ×©×•×œ×—×Ÿ ××¨×•×—×ª ×”×¢×¨×‘: {{table_number}}

×”×¦×•×•×ª ×©×œ× ×• ×™××ª×™×Ÿ ×œ×§×‘×œ ××ª ×¤× ×™×š ×‘×œ×•×‘×™.

× ×ª×¨××” ×‘×§×¨×•×‘! âœ¨',
     ARRAY['first_name', 'event_name', 'room_building', 'room_number', 'room_floor', 'checkin_time', 'table_number'],
     TRUE
   );
   ```

2. **VIP Departure Reminder Template:**
   - Include room details for checkout
   - Thank VIP for participation
   - Variables: first_name, event_name, room_number, checkout_time

3. **Standard Check-in Template with Room Variables:**
   - Non-VIP version without VIP messaging
   - Same room variables but simpler content
   - For ROOM-03 requirement

Templates must:
- Use existing message_templates schema
- Be idempotent (ON CONFLICT DO NOTHING or DO UPDATE)
- Include all room variables: room_building, room_number, room_floor, checkin_time
- Include table_number variable for seating
- Set is_system = TRUE for system templates
  </action>
  <verify>
- SQL syntax is valid
- All required variables are in ARRAY
- Templates are insertable without conflict
  </verify>
  <done>VIP message templates exist in seed file with room and table variables</done>
</task>

</tasks>

<verification>
After completing all tasks:
1. VIPBadge.tsx displays diamond icon with subtle styling
2. useVIPSorting.ts correctly prioritizes VIPs in sorted output
3. VIP templates include room_building, room_number, room_floor, table_number variables
4. All files follow EventFlow patterns (TypeScript, Tailwind, RTL)
</verification>

<success_criteria>
- VIP participants visually distinguished with subtle diamond icon (VIP-01)
- VIP-specific WhatsApp templates with personalized variables (VIP-02)
- WhatsApp templates include room details as dynamic variables (ROOM-03)
- VIPs sorted to top of participant lists
</success_criteria>

<output>
After completion, create `.planning/phases/07-networking-vip-infrastructure/07-02-SUMMARY.md`
</output>
